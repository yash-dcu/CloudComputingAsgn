1.) Upload dataset in the format CSV to HDFS

- local to VM instance
scp -i ccs-key.pem dataset1_1.csv dataset1_2.csv dataset1_3.csv dataset1_4.csv dataset1_5.csv dataset1_6.csv dataset2_1.csv ubuntu@ec2-52-91-79-23.compute-1.amazonaws.com:~/dataset/

- create new folder in HDFS
hdfs dfs -mkdir /all_data

- Put csv files at /all_data
hdfs dfs -put dataset1_1.csv /all_data
hdfs dfs -put dataset1_2.csv /all_data
hdfs dfs -put dataset1_3.csv /all_data
hdfs dfs -put dataset1_4.csv /all_data
hdfs dfs -put dataset1_5.csv /all_data
hdfs dfs -put dataset1_6.csv /all_data
hdfs dfs -put dataset2_1.csv /all_data

2.) Create and load Table for Dataset 1 in hive

- creating table
create table dataset1 (`#` int, date string, sender string, recepient1 string, subject string, text string) row format delimited fields terminated by ','
clustered by (date) into 4 buckets
stored as orc
tblproperties ('transactional'='true','skip.header.line.count'='1');

- loading data
load data inpath '/all_data/dataset1_1.csv' into table dataset1;
load data inpath '/all_data/dataset1_2.csv' into table dataset1;
load data inpath '/all_data/dataset1_3.csv' into table dataset1;
load data inpath '/all_data/dataset1_4.csv' into table dataset1;
load data inpath '/all_data/dataset1_5.csv' into table dataset1;
load data inpath '/all_data/dataset1_6.csv' into table dataset1;

3.) Create and load Table for Dataset 2 in hive

- creating table 
create table dataset2 (`#` int, sender_name string, email string, subject string, datetime string, cleaned_content string) row format delimited fields terminated by ','
clustered by (datetime) into 4 buckets
stored as orc
tblproperties ('transactional'='true','skip.header.line.count'='1');

- loading data
load data inpath '/all_data/dataset2_1.csv' into table dataset2;

4.) Merging both table to create final table dataset

- creating table Dataset
create table dataset (sender_id string, date_time string, subject string, body string) row format delimited fields terminated by ','
clustered by (date_time) into 4 buckets
stored as orc
tblproperties ('transactional'='true','skip.header.line.count'='1');

-loading data from dataset1
insert into table dataset select sender, date, subject, text from dataset1;

-loading data from dataset2
insert into table dataset select email, datetime, subject, cleaned_content from dataset2;















